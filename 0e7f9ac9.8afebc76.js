(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{100:function(e,t,a){"use strict";function n(e){return!0===/^(\w*:|\/\/)/.test(e)}function c(e){return void 0!==e&&!n(e)}a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return c}))},102:function(e,t,a){"use strict";var n=a(0),c=Object(n.createContext)(void 0);t.a=c},103:function(e,t,a){"use strict";var n=a(0),c=a(102);t.a=function(){var e=Object(n.useContext)(c.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},110:function(e,t,a){"use strict";var n=a(0),c=a.n(n),r=a(103),i=a(97),l=a(52),o=a.n(l),b=37,s=39;t.a=function(e){var t=e.block,a=e.children,l=e.defaultValue,p=e.values,d=e.groupId,u=Object(r.a)(),m=u.tabGroupChoices,O=u.setTabGroupChoices,j=Object(n.useState)(l),N=j[0],v=j[1];if(null!=d){var g=m[d];null!=g&&g!==N&&p.some((function(e){return e.value===g}))&&v(g)}var f=function(e){v(e),null!=d&&O(d,e)},h=[];return c.a.createElement("div",null,c.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(i.a)("tabs",{"tabs--block":t})},p.map((function(e){var t=e.value,a=e.label;return c.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":N===t,className:Object(i.a)("tabs__item",o.a.tabItem,{"tabs__item--active":N===t}),key:t,ref:function(e){return h.push(e)},onKeyDown:function(e){return function(e,t,a){switch(a.keyCode){case s:!function(e,t){var a=e.indexOf(t)+1;e[a]?e[a].focus():e[0].focus()}(e,t);break;case b:!function(e,t){var a=e.indexOf(t)-1;e[a]?e[a].focus():e[e.length-1].focus()}(e,t)}}(h,e.target,e)},onFocus:function(){return f(t)},onClick:function(){return f(t)}},a)}))),c.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},n.Children.toArray(a).filter((function(e){return e.props.value===N}))[0]))}},111:function(e,t,a){"use strict";var n=a(0),c=a.n(n);t.a=function(e){return c.a.createElement("div",null,e.children)}},59:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return b})),a.d(t,"metadata",(function(){return s})),a.d(t,"rightToc",(function(){return p})),a.d(t,"default",(function(){return u}));var n=a(2),c=a(6),r=(a(0),a(95)),i=a(110),l=a(111),o=a(98),b={id:"webservices",title:"Servicios Web de SUNAT",sidebar_label:"Servicios Web",description:"Env\xedo de comprobantes a los servicios SOAP de SUNAT."},s={unversionedId:"webservices",id:"webservices",isDocsHomePage:!1,title:"Servicios Web de SUNAT",description:"Env\xedo de comprobantes a los servicios SOAP de SUNAT.",source:"@site/docs/webservices.md",permalink:"/docs/webservices",editUrl:"https://github.com/thegreenter/F001-1/edit/master/website/docs/webservices.md",sidebar_label:"Servicios Web",sidebar:"docs",previous:{title:"Validar el comprobante electr\xf3nico",permalink:"/docs/validation"},next:{title:"Lista de Herramientas",permalink:"/docs/tools"}},p=[{value:"Credenciales",id:"credenciales",children:[]},{value:"BillService",id:"billservice",children:[{value:"Endpoints",id:"endpoints",children:[]}]},{value:"BillConsultService",id:"billconsultservice",children:[{value:"Endpoints",id:"endpoints-1",children:[]}]},{value:"Nomenclatura",id:"nomenclatura",children:[]},{value:"Zip",id:"zip",children:[]},{value:"Ejemplo",id:"ejemplo",children:[{value:"sendBill",id:"sendbill",children:[]},{value:"CDR",id:"cdr",children:[]}]}],d={rightToc:p};function u(e){var t=e.components,a=Object(c.a)(e,["components"]);return Object(r.b)("wrapper",Object(n.a)({},d,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"Para informar nuestros comprobantes electr\xf3nicos (XML) emitidos a SUNAT, disponemos de algunos servicios SOAP a los que necesitamos conectarnos para enviar estos archivos. "),Object(r.b)("h2",{id:"credenciales"},"Credenciales"),Object(r.b)("p",null,"Para conectarnos a estos servicios, necesitaremos unas credenciales, estas son la misma que la clave SOL."),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Dato"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Relaci\xf3n con clave SOL"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Usuario SOAP"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"RUC + Usuario SOL"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Clave SOAP"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"clave SOL"))))),Object(r.b)("p",null,"Ejemplo:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Usuario: ",Object(r.b)("inlineCode",{parentName:"li"},"20123456789MODDATOS")),Object(r.b)("li",{parentName:"ul"},"Clave: ",Object(r.b)("inlineCode",{parentName:"li"},"moddatos"))),Object(r.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(r.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"Usuario Secundario")),Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"Es recomendable crear un usuario secundario con solo permisos para procesos de facturaci\xf3n electr\xf3nica, y evitar utilizar la clave SOL principal. Puedes encontrar muchos tutoriales en\ninternet, pero recuerda que para que el usuario este operativo puede tomar hasta 24 horas despues de su creaci\xf3n. "))),Object(r.b)("h2",{id:"billservice"},"BillService"),Object(r.b)("p",null,"Este es el principal servicio SOAP, el cual define 3 metodos:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"sendBill"),": Para enviar comprobantes (FAC, BOL, NCR, NDB, RET, PERC, GRM)."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"sendSummary"),": Para enviar resumen diario, comuncaiones de baja, reversiones."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"getStatus"),": Consultar el estado del env\xedo de un resumen diario, c. de baja, reversiones.")),Object(r.b)("p",null,"Para ver el detalle de los m\xe9todos, puedes revisar el ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"http://contenido.app.sunat.gob.pe/insc/ComprobantesDePago+Electronicos/eFacturas+d+sistemas+contrib/Act23dic2014/Manual+de+autorizacion.pdf"}),"Manual del Programador - SUNAT")),Object(r.b)("p",null,"Existen 3 endpoints del mismo servicio para diferentes comprobantes."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Facturas, Boletas, notas de cr\xe9dito, d\xe9bito, Resumen diario de boletas, Comunicacion de bajas"),Object(r.b)("li",{parentName:"ol"},"Retenci\xf3n, Percepci\xf3n, Resumen de Reversiones"),Object(r.b)("li",{parentName:"ol"},"Guia de Remisi\xf3n")),Object(r.b)("h3",{id:"endpoints"},"Endpoints"),Object(r.b)("p",null,"SUNAT dispone de servicios para prueba (",Object(r.b)("strong",{parentName:"p"},"BETA"),") y producci\xf3n:"),Object(r.b)(i.a,{defaultValue:"beta",values:[{label:"BETA",value:"beta"},{label:"Produci\xf3n",value:"prod"}],mdxType:"Tabs"},Object(r.b)(l.a,{value:"beta",mdxType:"TabItem"},Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Servicio"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Ruta"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Factura"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("a",Object(n.a)({parentName:"td"},{href:"https://e-beta.sunat.gob.pe/ol-ti-itcpfegem-beta/billService?wsdl"}),"https://e-beta.sunat.gob.pe/ol-ti-itcpfegem-beta/billService?wsdl"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Retenci\xf3n y Percepci\xf3n"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("a",Object(n.a)({parentName:"td"},{href:"https://e-beta.sunat.gob.pe/ol-ti-itemision-otroscpe-gem-beta/billService?wsdl"}),"https://e-beta.sunat.gob.pe/ol-ti-itemision-otroscpe-gem-beta/billService?wsdl"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Guia"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("a",Object(n.a)({parentName:"td"},{href:"https://e-beta.sunat.gob.pe/ol-ti-itemision-guia-gem-beta/billService?wsdl"}),"https://e-beta.sunat.gob.pe/ol-ti-itemision-guia-gem-beta/billService?wsdl")))))),Object(r.b)(l.a,{value:"prod",mdxType:"TabItem"},Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Servicio"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Ruta"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Factura"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("a",Object(n.a)({parentName:"td"},{href:"https://e-factura.sunat.gob.pe/ol-ti-itcpfegem/billService?wsdl"}),"https://e-factura.sunat.gob.pe/ol-ti-itcpfegem/billService?wsdl"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Retenci\xf3n y Percepci\xf3n"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("a",Object(n.a)({parentName:"td"},{href:"https://e-factura.sunat.gob.pe/ol-ti-itemision-otroscpe-gem/billService?wsdl"}),"https://e-factura.sunat.gob.pe/ol-ti-itemision-otroscpe-gem/billService?wsdl"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Guia"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("a",Object(n.a)({parentName:"td"},{href:"https://e-guiaremision.sunat.gob.pe/ol-ti-itemision-guia-gem/billService?wsdl"}),"https://e-guiaremision.sunat.gob.pe/ol-ti-itemision-guia-gem/billService?wsdl"))))))),Object(r.b)("h2",{id:"billconsultservice"},"BillConsultService"),Object(r.b)("p",null,"Este servicio se utiliza para consultar el estado de comprobantes previamente enviados y obtener el ",Object(r.b)("inlineCode",{parentName:"p"},"CDR"),", tener en cuenta que solo esta habilitado para facturas y notas de cr\xe9dito, d\xe9bito releacionadas."),Object(r.b)("p",null,"M\xe9todos SOAP:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"getStatusCdr"),": Para obtener el CDR, si el comprobante fue previamente procesado.")),Object(r.b)("h3",{id:"endpoints-1"},"Endpoints"),Object(r.b)("p",null,"El servicio solo esta disponible en produci\xf3n."),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Servicio"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Ruta"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Consulta CDR"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("a",Object(n.a)({parentName:"td"},{href:"https://e-factura.sunat.gob.pe/ol-it-wsconscpegem/billConsultService?wsdl"}),"https://e-factura.sunat.gob.pe/ol-it-wsconscpegem/billConsultService?wsdl"))))),Object(r.b)("h2",{id:"nomenclatura"},"Nomenclatura"),Object(r.b)("p",null,"SUNAT exige que el nombre del archivo XML siga un formato espec\xedfico. "),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{}),"{RUC}-{TIPO_DOC}-{SERIE}-{CORRELATIVO}.xml\n")),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Sigla"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Descripci\xf3n"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"RUC")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Ruc del emisor")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"TIPO_DOC")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Tipo de Comprobante (Cat\xe1logo 01)")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"SERIE")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Serie del comprobante")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"CORRELATIVO")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Correlativo del comprobante")))),Object(r.b)("p",null,"Ejemplos:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"20123456789-01-F001-4.xml")," (Factura)"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"20123456789-07-F001-5.xml")," (Nota de cr\xe9dito relacionada a Factura)"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"20123456789-03-B001-8.xml")," (Boleta)"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"20123456789-07-B001-9.xml")," (Nota de cr\xe9dito relacionada a Boleta)"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"20123456789-09-T001-155.xml")," (Gu\xeda de Remisi\xf3n)"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"20123456789-40-P001-222.xml")," (Percepcion)")),Object(r.b)("p",null,"Adicionalmente, hay una diferencia con respecto al resumen diario, comunicaciones de baja y resumen de reversiones, que siguen\nel siguiente formato."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{}),"{RUC}-{TIPO}-{FECHA}-{CORRELATIVO}.xml\n")),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Sigla"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Descripci\xf3n"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"RUC")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Ruc del emisor")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"TIPO_DOC")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Tipo documento (",Object(r.b)("inlineCode",{parentName:"td"},"RC"),": Resumen diario, ",Object(r.b)("inlineCode",{parentName:"td"},"RA"),": C. de baja, ",Object(r.b)("inlineCode",{parentName:"td"},"RR"),": Reversiones )")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"SERIE")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Fecha generaci\xf3n del documento (formato: ",Object(r.b)("inlineCode",{parentName:"td"},"YYYYMMDD"),")")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"CORRELATIVO")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Correlativo del documento (m\xe1ximo longitud: ",Object(r.b)("inlineCode",{parentName:"td"},"5"),")")))),Object(r.b)("p",null,"Ejemplos:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"20123456789-RC-20200930-211.xml")," (Resumen diario de boletas)"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"20123456789-RA-20200929-433.xml")," (Comunicaci\xf3n de bajas)"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"20123456789-RR-20201001-11122.xml")," (Resumen de reversiones)")),Object(r.b)("h2",{id:"zip"},"Zip"),Object(r.b)("p",null,"Antes de ejecutar el servicio SOAP, SUNAT necesita que el archivo xml (factura) sea comprimido en formato ",Object(r.b)("inlineCode",{parentName:"p"},"zip"),". Para ello podemos utlizar cualquier programa de escritorio (7z, winrar, etc) o en linea de comandos, como el siguiente ejemplo."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"zip 20123456789-01-F001-1.zip 20123456789-01-F001-1.xml\n")),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"El nombre del archivo ",Object(r.b)("inlineCode",{parentName:"p"},"zip")," es el mismo que el nombre del ",Object(r.b)("inlineCode",{parentName:"p"},"xml"),".")),Object(r.b)("h2",{id:"ejemplo"},"Ejemplo"),Object(r.b)("p",null,"En este ejemplo, enviaremos la factura electr\xf3nica construida en las secciones anteriores, puedes descargarlo desde este ",Object(r.b)("a",{href:Object(o.a)("file/20123456789-01-F001-1.xml"),target:"'_blank'"},"enlace"),"."),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"Debemos tener nuestro comprobante en formato zip: ",Object(r.b)("inlineCode",{parentName:"p"},"20123456789-01-F001-1.zip"))),Object(r.b)("h3",{id:"sendbill"},"sendBill"),Object(r.b)("p",null,"Para enviar el zip en la trama SOAP, necesitamos codificar el archivo en formato ",Object(r.b)("inlineCode",{parentName:"p"},"base64"),"."),Object(r.b)("p",null,"Podemos usar el siguiente comando:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"base64 20123456789-01-F001-1.zip\n")),Object(r.b)("p",null,"En la siguiente trama reemplazar el resultado en la marca ",Object(r.b)("inlineCode",{parentName:"p"},"ZIP_BASE_64"),", adem\xe1s estamos incluyendo el nombre del archivo y la cabecera de seguridad donde se incluye las credenciales (clave SOL)."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-xml",metastring:'title="./sendbill.xml" {13}',title:'"./sendbill.xml"',"{13}":!0}),'<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://service.sunat.gob.pe" xmlns:ns2="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">\n   <SOAP-ENV:Header>\n      <ns2:Security>\n         <ns2:UsernameToken>\n            <ns2:Username>20123456789MODDATOS</ns2:Username>\n            <o:Password xmlns:o="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">moddatos</o:Password>\n         </ns2:UsernameToken>\n      </ns2:Security>\n   </SOAP-ENV:Header>\n   <SOAP-ENV:Body>\n      <ns1:sendBill>\n        <fileName>20123456789-01-F001-1.zip</fileName>\n        <contentFile>ZIP_BASE_64</contentFile>\n      </ns1:sendBill>\n   </SOAP-ENV:Body>\n</SOAP-ENV:Envelope>\n')),Object(r.b)("p",null,"Ahora podemos invocar el servicio SOAP, utilizaremos ",Object(r.b)("inlineCode",{parentName:"p"},"curl")," para esta operaci\xf3n."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),'curl -X POST -H "Content-Type: text/xml" --data-binary @trama.xml \\\n https://e-beta.sunat.gob.pe/ol-ti-itcpfegem-beta/billService\n')),Object(r.b)("p",null,"El resultado ser\xe1 el siguiente."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-xml",metastring:"{6}","{6}":!0}),'<?xml version="1.0" encoding="UTF-8"?>\n<soap-env:Envelope xmlns:soap-env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">\n<soap-env:Header/>\n<soap-env:Body>\n    <br:sendBillResponse xmlns:br="http://service.sunat.gob.pe">\n        <applicationResponse>ZIP_BASE64_RESPONSE</applicationResponse>\n    </br:sendBillResponse>\n</soap-env:Body>\n</soap-env:Envelope>\n')),Object(r.b)("p",null,"Guardamos el valor de la marca ",Object(r.b)("inlineCode",{parentName:"p"},"ZIP_BASE64_RESPONSE")," en un archivo ",Object(r.b)("inlineCode",{parentName:"p"},"response.txt"),", para proceder a decodificarlo y obtener el ZIP que contiene la respuesta."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"base64 -d response.txt > result.zip\n")),Object(r.b)("h3",{id:"cdr"},"CDR"),Object(r.b)("p",null,"Dentro del archivo zip decodificado (",Object(r.b)("inlineCode",{parentName:"p"},"result.zip"),"), encontraremos un archivo xml que representa el CDR (Comprobante de recepci\xf3n)."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-xml",metastring:'title="R-20123456789-01-F001-123.xml" {46}',title:'"R-20123456789-01-F001-123.xml"',"{46}":!0}),'<?xml version="1.0" encoding="UTF-8"?>\n<ar:ApplicationResponse xmlns:ar="urn:oasis:names:specification:ubl:schema:xsd:ApplicationResponse-2" xmlns:cac="urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2" xmlns:cbc="urn:oasis:names:specification:ubl:schema:xsd:CommonBasicComponents-2" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:ext="urn:oasis:names:specification:ubl:schema:xsd:CommonExtensionComponents-2" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">\n   <ext:UBLExtensions>\n      <ext:UBLExtension>\n         <ext:ExtensionContent>\n            <Signature xmlns="http://www.w3.org/2000/09/xmldsig#">\n               \x3c!-- Omitido para ejemplo --\x3e\n            </Signature>\n         </ext:ExtensionContent>\n      </ext:UBLExtension>\n   </ext:UBLExtensions>\n   <cbc:ID>1601506416977</cbc:ID>\n   <cbc:IssueDate>2020-09-24T11:38:45</cbc:IssueDate>\n   <cbc:IssueTime>00:00:00</cbc:IssueTime>\n   <cbc:ResponseDate>2020-09-30</cbc:ResponseDate>\n   <cbc:ResponseTime>17:53:36</cbc:ResponseTime>\n   <cac:Signature>\n      <cbc:ID>SignSUNAT</cbc:ID>\n      <cac:SignatoryParty>\n         <cac:PartyIdentification>\n            <cbc:ID>20131312955</cbc:ID>\n         </cac:PartyIdentification>\n         <cac:PartyName>\n            <cbc:Name>SUNAT</cbc:Name>\n         </cac:PartyName>\n      </cac:SignatoryParty>\n      <cac:DigitalSignatureAttachment>\n         <cac:ExternalReference>\n            <cbc:URI>#SignSUNAT</cbc:URI>\n         </cac:ExternalReference>\n      </cac:DigitalSignatureAttachment>\n   </cac:Signature>\n   <cac:SenderParty>\n      <cac:PartyIdentification>\n         <cbc:ID>20131312955</cbc:ID>\n      </cac:PartyIdentification>\n   </cac:SenderParty>\n   <cac:ReceiverParty>\n      <cac:PartyIdentification>\n         <cbc:ID>20123456789</cbc:ID>\n      </cac:PartyIdentification>\n   </cac:ReceiverParty>\n   <cac:DocumentResponse>\n      <cac:Response>\n         <cbc:ReferenceID>F001-123</cbc:ReferenceID>\n         <cbc:ResponseCode>0</cbc:ResponseCode>\n         <cbc:Description>La Factura numero F001-123, ha sido aceptada</cbc:Description>\n      </cac:Response>\n      <cac:DocumentReference>\n         <cbc:ID>F001-123</cbc:ID>\n      </cac:DocumentReference>\n      <cac:RecipientParty>\n         <cac:PartyIdentification>\n            <cbc:ID>6-20000000001</cbc:ID>\n         </cac:PartyIdentification>\n      </cac:RecipientParty>\n   </cac:DocumentResponse>\n</ar:ApplicationResponse>\n')),Object(r.b)("p",null,"Prestaremos especial atenci\xf3n al valor del nodo ",Object(r.b)("inlineCode",{parentName:"p"},"cbc:ResponseCode"),", que contiene el c\xf3digo de respuesta, y que nos permitir\xe1 saber si el comprobante fue aceptado o rechazado."),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Codigo"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Descripcion"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Acci\xf3n"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"0"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Aceptado"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"-")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"2000 a 3999"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Rechazado"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Emitir nueva factura")))),Object(r.b)("p",null,"En ocasiones el CDR contendr\xe1 observaciones en el comprobante."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-xml"}),'\x3c!-- ... --\x3e\n<cbc:ResponseTime>18:38:20</cbc:ResponseTime>\n<cbc:Note>4287 - El precio unitario de la operaci\xf3n que est\xe1 informando difiere de los c\xe1lculos realizados en base a la informaci\xf3n remitida - Error en la linea: 1 (nodo: "/Invoice/cac:InvoiceLine/cac:PricingReference/cac:AlternativeConditionPrice/cbc:PriceAmount", valor:"100")</cbc:Note>\n<cbc:Note>4309 - La sumatoria de valor de venta no corresponde a los importes consignados - (nodo: "/Invoice/cac:LegalMonetaryTotal/cbc:LineExtensionAmount", valor:"300.00")</cbc:Note>\n<cac:Signature>\n\x3c!-- ... --\x3e\n')),Object(r.b)("p",null,"Estas observaciones deber\xe1n ser corregidas en posteriores emisiones."))}u.isMDXComponent=!0},95:function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return m}));var n=a(0),c=a.n(n);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,c=function(e,t){if(null==e)return{};var a,n,c={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(c[a]=e[a]);return c}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(c[a]=e[a])}return c}var b=c.a.createContext({}),s=function(e){var t=c.a.useContext(b),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=s(e.components);return c.a.createElement(b.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return c.a.createElement(c.a.Fragment,{},t)}},u=c.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,i=e.parentName,b=o(e,["components","mdxType","originalType","parentName"]),p=s(a),u=n,m=p["".concat(i,".").concat(u)]||p[u]||d[u]||r;return a?c.a.createElement(m,l(l({ref:t},b),{},{components:a})):c.a.createElement(m,l({ref:t},b))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,i=new Array(r);i[0]=u;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var b=2;b<r;b++)i[b]=a[b];return c.a.createElement.apply(null,i)}return c.a.createElement.apply(null,a)}u.displayName="MDXCreateElement"},96:function(e,t,a){"use strict";var n=a(0),c=a(21);t.a=function(){var e=Object(n.useContext)(c.a);if(null===e)throw new Error("Docusaurus context not provided");return e}},97:function(e,t,a){"use strict";function n(e){var t,a,c="";if("string"==typeof e||"number"==typeof e)c+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(a=n(e[t]))&&(c&&(c+=" "),c+=a);else for(t in e)e[t]&&(c&&(c+=" "),c+=t);return c}t.a=function(){for(var e,t,a=0,c="";a<arguments.length;)(e=arguments[a++])&&(t=n(e))&&(c&&(c+=" "),c+=t);return c}},98:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i}));var n=a(96),c=a(100);function r(){var e=Object(n.a)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,a=void 0===t?"/":t,r=e.url;return{withBaseUrl:function(e,t){return function(e,t,a,n){var r=void 0===n?{}:n,i=r.forcePrependBaseUrl,l=void 0!==i&&i,o=r.absolute,b=void 0!==o&&o;if(!a)return a;if(a.startsWith("#"))return a;if(Object(c.b)(a))return a;if(l)return t+a;var s=!a.startsWith(t)?t+a.replace(/^\//,""):a;return b?e+s:s}(r,a,e,t)}}}function i(e,t){return void 0===t&&(t={}),(0,r().withBaseUrl)(e,t)}}}]);